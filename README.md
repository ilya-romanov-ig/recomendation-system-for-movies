# Рекомендательная система для фильмов

## Описание

Данный проект нацелен на создание моделей рекомендательных систем на основе колаборативной фильтрации (User-Based, Item-Based) и матричной факторизации при помощи модели ALS.

## Данные

В качестве основного датасеты был использован [MovieLens Small](https://grouplens.org/datasets/movielens/latest/). Данные состоят из 4-х .csv файлов:

- links.csv - Id фильмов на платформах IMDB и TMDB

- movies.csv - таблица из id фильма (```movieId```), названия (```title```), списка жанров (```genres```).

- ratings.csv - таблица из id пользователя (```userId```), id фильма (```movieId```), выставленной пользователем оценки (```rating```), временной метки (```timestamp```).

- tags.csv - таблица из id пользователя (```userId```), id фильма (```movieId```), выставленного пользователем тэга (```tag```), временной метки (```timestamp```).

## Установка

Установка данных: ```pip install requirements.txt```

## Запуск

Для демонстрации действия моделей:

- ```python src/show.py``` - запуск...

## Методология и результаты

Для создания рейтинговой системы были созданы следующие модели:

- UBCF (User-Based Colaborative Filtering) - метод, предназначенный для нахождения похожих пользователей при помощи составления матрциы схожести (similarity matrix) через косинусную схожесть из матрицы пользователь-фильм. Метод находит ```k``` самых схожих с данным пользователем пользователей и усредняет рейтинг. На основе полученного усреднённого рейтинга составляется рекомендация.

- IBCF (Item-Based Colaborative Filtering) - метод, предназначенный для нахождения похожих фильмов при помощи составления матрциы схожести (similarity matrix) через косинусную схожесть из матрицы фильм-пользователь. Метод находит ```k``` самых схожих с данным пользователем пользователей оценивших фильм и усредняет рейтинг. На основе полученного усреднённого рейтинга составляется рекомендация.

- ALS (Alternating Least Squares) - метод, основанный на нахождении скрытых признаков для каждого пользователя при помощи алгоритма "чередующихся наименьших квадратов". Алгоритм нацелен на заполнение разряженных матриц для пользователей и товаров путём минимизации квадрата ошибки.

Вся часть анализа данных находится в файле ```notebooks/01_eda.ipynb```. Во время анализа значимых зависимостей между пользователями и фильмами обнаружено не было.

Далее в файлах ```notebooks/02_user_based_cf.ipynb```, ```notebooks/03_item_based_cf.ipynb```, ```notebooks/04_implicit.ipynb``` были проведены исследования моделей UBCF, IBCF, ALS.

Результаты сравнения UBCF и IBCF:

| Model | RMSE |
| :---: | :---: |
| UBCF | 1.169 |
| IBCF | 1.092 |

Поскольку результаты модели ALS не нацелены на численное сравнение по метрике RMSE, исследование проводилось по следующим метрикам:
- precision@K
- recall@K
- map@K
- ndcg@K

Были получены следующие результаты:

|Metric|Value|
|:---:|:---:|
|Precision@K||
|Recall@K||
|MAP@K||
|NDCG@K||

## Итог

В итоге были получены 3 качественные модели для предсказания рейтинга фильма (товара) и создания рекомендаций, которые готовы к введению в продакшн.

## Автор

Романов Илья